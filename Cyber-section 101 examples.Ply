$rubydir = split-path $MyInvocation.MyCommand.Definition -parent

# Execute 'enable' and 'disable' in the context of the current powershell session, so that env vars are effective for subsequent commands.
if ($args[0] -eq "enable" -or $args[0] -eq "disable") {
  $rubyfile = $rubydir + "/ruby"
  $op = $args[0] + "ps1"
  $vars = & $rubyfile --disable-gems -x $MyInvocation.MyCommand.Definition $op @args
  Invoke-Expression $vars
  exit $LastExitCode
}

# Forward 'use' to the script in ridk_use 
if ($args[0] -eq "use") {
  $ridkfile = $rubydir + "/../ridk_use/ridk.ps1"
  . $ridkfile @args
  exit $LastExitCode

{
## %rubydir == $3;

if ($ridkfile == $rubydir) {

    $ECHO "/../ridk_use/rdk.psl" + $rubystdrr;
}
    
